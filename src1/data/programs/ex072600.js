// Chapter 7 Example 7.26
// Chapter 7 Example 7.26

const ex072600 = {
  "id": "ex072600",
  "title": "ex072600",
  "displayName": "Chapter 7 Example 7.26",
  "description": "Chapter 7 Example 7.26",
  "category": "DSP - Chapter 07",
  "chapter": "07",
  "source": "matlab",
  "pythonCode": "#!/usr/bin/env python3\n# Title: Chapter 7 Example 7.26\n# Chapter: 07\n# Source: Ingle DSP MATLAB Programs\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport io\nimport base64\n\n# Chapter 7 Example 7.26\r\n\r\n# Staircase filter design using PM algorithm\r\n\r\n# w1 = 0; w2 = 0.3*np.pi; delta1 = 0.01\nw3 = 0.4*np.pi; w4 = 0.7*np.pi; delta2 = 0.005\nw5 = 0.8*np.pi; w6 = np.pi; delta3 = 0.001\ndeltaH = np.max([delta1,delta2,delta3]); deltaL = np.min([delta1,delta2,delta3])\nweights = [delta3/delta1 delta3/delta2 1]\r\n\r\ndelta_f = np.min((w3-w2)/(2*np.pi), (w5-w3)/(2*np.pi))\r\n\r\nM = np.ceil((-20*np.log10(np.sqrt(delta1*delta2))-13)/(14.6*delta_f)+1)\r\n\r\nf = [0 w2/np.pi w3/np.pi w4/np.pi w5/np.pi 1]\r\n\r\nm = [1 1 0.5 0.5 0 0]\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\ndelta_w = 2*np.pi/1000\nw1i=np.floor(w1/delta_w)+1; w2i = np.floor(w2/delta_w)+1\nw3i=np.floor(w3/delta_w)+1; w4i = np.floor(w4/delta_w)+1\nw5i=np.floor(w5/delta_w)+1; w6i = np.floor(w6/delta_w)+1\nAsd = -np.max(dbnp.arange(w5i, w6i + 1))\r\n\r\n# optimum value was found at M=49\r\n\r\nM = 49\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(w5i, w6i + 1))\r\n\r\n[Hr,omega,P,L] = ampl_res(h)\n# # Plots\r\n\r\nfig = plt.figure(1)\n plt.subplot(1, 1, 1)\nplt.subplot(2, 2, 1)\n stemnp.arange([0, M-1],h + 1, 1); plt.title('Actual Impulse Response')\nplt.plt.axis([0,M-1,-0.1,0.6]); plt.xlabel('n')\n plt.ylabel('h(n)')\nset(gca,'XTickMode','manual','XTick',[0,M-1])\r\n\r\nsetnp.arange(gca,'YTickMode','manual','YTick',[-0.1, 0.6] + 0.1, 0.1)\r\n\r\nplt.subplot(2, 2, 2)\nplt.plt.plt.plot(w/np.pi,db)\nplt.title('Magnitude Response in dB')\n\r\n\r\nplt.plt.axis([0,1,-80,10]); plt.xlabel('frequency in np.pi units')\n plt.ylabel('DECIBELS')\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-60,0])\nset(gca,'YTickLabelMode','manual','YTickLabels',['60';' 0']);plt.grid(True)\nplt.subplot(2, 2, 3)\nplt.plt.plt.plot(omega/np.pi,Hr)\nplt.title('Amplitude Response')\n\r\n\r\nplt.plt.axis([0 1 -0.1 1.1]); plt.xlabel('frequency in np.pi units')\n plt.ylabel('Hr(w)')\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,0.5,1]);plt.grid(True)\ndelta_w = 2*np.pi/1000; sp_edge = w5/delta_w+1\nplt.subplot(2, 2, 4)\n \r\n\r\nb1w = omeganp.arange(w1i, w2i + 1)/np.pi; b1e = (Hrnp.arange(w1i, w2i + 1)-m(1))*weights(1)\nb2w = omeganp.arange(w3i, w4i + 1)/np.pi; b2e = (Hrnp.arange(w3i, w4i + 1)-m(3))*weights(2)\nb3w = omeganp.arange(w5i, w6i + 1)/np.pi; b3e = (Hrnp.arange(w5i, w6i + 1)-m(5))*weights(3)\nplt.plt.plt.plot(b1w,b1e,b2w,b2e,b3w,b3e)\n\r\n\r\nplt.title('Weighted Error')\n\r\n\r\nplt.plt.axis([0,1,-delta3,delta3])\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('Hr(w)')\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-delta3,0,delta3])\nplt.grid(True)\n# Save plot to base64\nbuf = io.BytesIO()\nplt.tight_layout()\nplt.savefig(buf, format='png', dpi=100, bbox_inches='tight')\nbuf.seek(0)\nimg_base64 = base64.b64encode(buf.read()).decode('utf-8')\nplt.close()\nprint(f\"data:image/png;base64,{img_base64}\")\n",
  "matlabCode": "% Chapter 7 Example 7.26\r\n\r\n%           Staircase filter design using PM algorithm\r\n\r\n%\r\n\r\nw1 = 0; w2 = 0.3*pi; delta1 = 0.01;\r\n\r\nw3 = 0.4*pi; w4 = 0.7*pi; delta2 = 0.005;\r\n\r\nw5 = 0.8*pi; w6 = pi; delta3 = 0.001;\r\n\r\ndeltaH = max([delta1,delta2,delta3]); deltaL = min([delta1,delta2,delta3]);\r\n\r\nweights = [delta3/delta1 delta3/delta2 1]\r\n\r\ndelta_f = min((w3-w2)/(2*pi), (w5-w3)/(2*pi))\r\n\r\nM = ceil((-20*log10(sqrt(delta1*delta2))-13)/(14.6*delta_f)+1)\r\n\r\nf = [0 w2/pi w3/pi w4/pi w5/pi 1]\r\n\r\nm = [1 1 0.5 0.5 0 0];\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\ndelta_w = 2*pi/1000;\r\n\r\nw1i=floor(w1/delta_w)+1; w2i = floor(w2/delta_w)+1;\r\n\r\nw3i=floor(w3/delta_w)+1; w4i = floor(w4/delta_w)+1;\r\n\r\nw5i=floor(w5/delta_w)+1; w6i = floor(w6/delta_w)+1;\r\n\r\nAsd = -max(db(w5i:w6i))\r\n\r\n% optimum value was found at M=49\r\n\r\nM = 49;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(w5i:w6i))\r\n\r\n[Hr,omega,P,L] = ampl_res(h);\r\n\r\n%\r\n\r\n% Plots\r\n\r\nfigure(1); subplot(1,1,1)\r\n\r\nsubplot(2,2,1); stem([0:1:M-1],h); title('Actual Impulse Response')\r\n\r\naxis([0,M-1,-0.1,0.6]); xlabel('n'); ylabel('h(n)')\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,M-1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-0.1:0.1:0.6])\r\n\r\nsubplot(2,2,2);plot(w/pi,db);title('Magnitude Response in dB');\r\n\r\naxis([0,1,-80,10]); xlabel('frequency in pi units'); ylabel('DECIBELS')\r\n\r\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-60,0]);\r\n\r\nset(gca,'YTickLabelMode','manual','YTickLabels',['60';' 0']);grid\r\n\r\nsubplot(2,2,3);plot(omega/pi,Hr);title('Amplitude Response');\r\n\r\naxis([0 1 -0.1 1.1]); xlabel('frequency in pi units'); ylabel('Hr(w)')\r\n\r\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,0.5,1]);grid\r\n\r\ndelta_w = 2*pi/1000; sp_edge = w5/delta_w+1;\r\n\r\nsubplot(2,2,4); \r\n\r\nb1w = omega(w1i:w2i)/pi; b1e = (Hr(w1i:w2i)-m(1))*weights(1); \r\n\r\nb2w = omega(w3i:w4i)/pi; b2e = (Hr(w3i:w4i)-m(3))*weights(2); \r\n\r\nb3w = omega(w5i:w6i)/pi; b3e = (Hr(w5i:w6i)-m(5))*weights(3); \r\n\r\nplot(b1w,b1e,b2w,b2e,b3w,b3e);\r\n\r\ntitle('Weighted Error');\r\n\r\naxis([0,1,-delta3,delta3]);\r\n\r\nxlabel('frequency in pi units'); ylabel('Hr(w)')\r\n\r\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-delta3,0,delta3]);\r\n\r\ngrid\r\n\r\n",
  "defaultParams": {},
  "params": [],
  "tags": [
    "chapter07",
    "dsp",
    "ex072600"
  ],
  "wikipediaLinks": [
    {
      "title": "Digital signal processing",
      "url": "https://en.wikipedia.org/wiki/Digital_signal_processing"
    }
  ]
};

export default ex072600;
