// Chapter 7 Example 7.24
// Chapter 7 Example 7.24

const ex072400 = {
  "id": "ex072400",
  "title": "ex072400",
  "displayName": "Chapter 7 Example 7.24",
  "description": "Chapter 7 Example 7.24",
  "category": "DSP - Chapter 07",
  "chapter": "07",
  "source": "matlab",
  "pythonCode": "#!/usr/bin/env python3\n# Title: Chapter 7 Example 7.24\n# Chapter: 07\n# Source: Ingle DSP MATLAB Programs\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport io\nimport base64\n\n# Chapter 7 Example 7.24\r\n\r\n# Bandpass filter design using PM algorithm\r\n\r\n# ws1 = 0.2*np.pi; wp1 = 0.35*np.pi; wp2 = 0.65*np.pi; ws2 = 0.8*np.pi\nRp = 1.0; As = 60\ndelta1 = (10**(Rp/20)-1)/(10**(Rp/20)+1)\ndelta2 = (1+delta1)*(10**(-As/20))\ndeltaH = np.max(delta1,delta2); deltaL = np.min(delta1,delta2)\nweights = [1 delta2/delta1 1]\ndelta_f =np.min((ws2-wp2)/(2*np.pi), (wp1-ws1)/(2*np.pi))\nM = np.ceil((-20*np.log10(np.sqrt(delta1*delta2))-13)/(14.6*delta_f)+1)\r\n\r\nf = [0 ws1/np.pi wp1/np.pi wp2/np.pi ws2/np.pi 1]\nm = [0 0 1 1 0 0]\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\ndelta_w=2*np.pi/1000\nws1i=np.floor(ws1/delta_w)+1; wp1i = np.floor(wp1/delta_w)+1\nws2i=np.floor(ws2/delta_w)+1; wp2i = np.floor(wp2/delta_w)+1\nAsd = -np.max(dbnp.arange(1, ws1i + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(1, ws1/delta_w + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(1, ws1/delta_w + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(1, ws1/delta_w + 1, 1))\r\n\r\nM\r\n\r\n[Hr,omega,P,L] = ampl_res(h)\n# # Plots\r\n\r\nfig = plt.figure(1)\n plt.subplot(1, 1, 1)\nplt.subplot(2, 2, 1)\n stemnp.arange([0, M-1],h + 1, 1); plt.title('Actual Impulse Response')\nplt.plt.axis([0,M-1,-0.4,0.5]); plt.xlabel('n')\n plt.ylabel('h(n)')\nset(gca,'XTickMode','manual','XTick',[0,M-1])\r\n\r\nsetnp.arange(gca,'YTickMode','manual','YTick',[-0.4, 0.5] + 0.2, 0.2)\r\n\r\nplt.subplot(2, 2, 2)\nplt.plt.plt.plot(w/np.pi,db)\nplt.title('Magnitude Response in dB')\n\r\n\r\nplt.plt.axis([0,1,-80,10]); plt.xlabel('frequency in np.pi units')\n plt.ylabel('DECIBELS')\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-60,0])\nset(gca,'YTickLabelMode','manual','YTickLabels',['60';' 0']);plt.grid(True)\nplt.subplot(2, 2, 3)\nplt.plt.plt.plot(omega/np.pi,Hr)\nplt.title('Amplitude Response')\n\r\n\r\nplt.plt.axis([0 1 -0.1 1.1]); plt.xlabel('frequency in np.pi units')\n plt.ylabel('Hr(w)')\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,1]);plt.grid(True)\ndelta_w = 2*np.pi/1000; sp_edge1 = ws1/delta_w+1; sp_edge2 = ws2/delta_w+1\nplt.subplot(2, 2, 4)\n\r\n\r\nsb1w = omeganp.arange(1, ws1i + 1, 1)/np.pi; sb1e = Hrnp.arange(1, ws1i + 1, 1)\npbw = omeganp.arange(wp1i, wp2i + 1)/np.pi; pbe = Hrnp.arange(wp1i, wp2i + 1)-1\nsb2w = omeganp.arange(ws2i, 501 + 1)/np.pi; sb2e = Hrnp.arange(ws2i, 501 + 1)\nplt.plt.plt.plot(sb1w,sb1e,pbw,pbe*(delta2/delta1)\n,sb2w,sb2e)\nplt.title('Weighted Error')\n\r\n\r\nplt.plt.axis([0,1,-deltaL,deltaL])\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('Hr(w)')\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-deltaL,0,deltaL])\nset(gca,'XGrid','on','YGrid','on')\r\n\r\n\n# Save plot to base64\nbuf = io.BytesIO()\nplt.tight_layout()\nplt.savefig(buf, format='png', dpi=100, bbox_inches='tight')\nbuf.seek(0)\nimg_base64 = base64.b64encode(buf.read()).decode('utf-8')\nplt.close()\nprint(f\"data:image/png;base64,{img_base64}\")\n",
  "matlabCode": "% Chapter 7 Example 7.24\r\n\r\n%           Bandpass filter design using PM algorithm\r\n\r\n%\r\n\r\nws1 = 0.2*pi; wp1 = 0.35*pi; wp2 = 0.65*pi; ws2 = 0.8*pi;\r\n\r\nRp = 1.0; As = 60;\r\n\r\ndelta1 = (10^(Rp/20)-1)/(10^(Rp/20)+1);\r\n\r\ndelta2 = (1+delta1)*(10^(-As/20));\r\n\r\ndeltaH = max(delta1,delta2); deltaL = min(delta1,delta2);\r\n\r\nweights = [1 delta2/delta1 1];\r\n\r\ndelta_f =min((ws2-wp2)/(2*pi), (wp1-ws1)/(2*pi));\r\n\r\nM = ceil((-20*log10(sqrt(delta1*delta2))-13)/(14.6*delta_f)+1)\r\n\r\nf = [0 ws1/pi wp1/pi wp2/pi ws2/pi 1];\r\n\r\nm = [0 0 1 1 0 0];\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\ndelta_w=2*pi/1000;\r\n\r\nws1i=floor(ws1/delta_w)+1; wp1i = floor(wp1/delta_w)+1;\r\n\r\nws2i=floor(ws2/delta_w)+1; wp2i = floor(wp2/delta_w)+1;\r\n\r\nAsd = -max(db(1:1:ws1i))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(1:1:ws1/delta_w))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(1:1:ws1/delta_w))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(1:1:ws1/delta_w))\r\n\r\nM\r\n\r\n[Hr,omega,P,L] = ampl_res(h);\r\n\r\n%\r\n\r\n% Plots\r\n\r\nfigure(1); subplot(1,1,1)\r\n\r\nsubplot(2,2,1); stem([0:1:M-1],h); title('Actual Impulse Response')\r\n\r\naxis([0,M-1,-0.4,0.5]); xlabel('n'); ylabel('h(n)')\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,M-1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-0.4:0.2:0.5])\r\n\r\nsubplot(2,2,2);plot(w/pi,db);title('Magnitude Response in dB');\r\n\r\naxis([0,1,-80,10]); xlabel('frequency in pi units'); ylabel('DECIBELS')\r\n\r\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-60,0]);\r\n\r\nset(gca,'YTickLabelMode','manual','YTickLabels',['60';' 0']);grid\r\n\r\nsubplot(2,2,3);plot(omega/pi,Hr);title('Amplitude Response');\r\n\r\naxis([0 1 -0.1 1.1]); xlabel('frequency in pi units'); ylabel('Hr(w)')\r\n\r\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,1]);grid\r\n\r\ndelta_w = 2*pi/1000; sp_edge1 = ws1/delta_w+1; sp_edge2 = ws2/delta_w+1;\r\n\r\nsubplot(2,2,4);\r\n\r\nsb1w = omega(1:1:ws1i)/pi; sb1e = Hr(1:1:ws1i); \r\n\r\npbw = omega(wp1i:wp2i)/pi; pbe = Hr(wp1i:wp2i)-1;\r\n\r\nsb2w = omega(ws2i:501)/pi; sb2e = Hr(ws2i:501); \r\n\r\nplot(sb1w,sb1e,pbw,pbe*(delta2/delta1),sb2w,sb2e);\r\n\r\ntitle('Weighted Error');\r\n\r\naxis([0,1,-deltaL,deltaL]);\r\n\r\nxlabel('frequency in pi units'); ylabel('Hr(w)')\r\n\r\nset(gca,'XTickMode','manual','XTick',f)\r\n\r\nset(gca,'YTickMode','manual','YTick',[-deltaL,0,deltaL]);\r\n\r\nset(gca,'XGrid','on','YGrid','on')\r\n\r\n",
  "defaultParams": {},
  "params": [],
  "tags": [
    "chapter07",
    "dsp",
    "ex072400"
  ],
  "wikipediaLinks": [
    {
      "title": "Digital signal processing",
      "url": "https://en.wikipedia.org/wiki/Digital_signal_processing"
    }
  ]
};

export default ex072400;
