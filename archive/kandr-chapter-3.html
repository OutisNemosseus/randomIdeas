<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>K&R 2e Solutions - Chapter 3</title>

  <style>
    :root {
      --bg: #0b1020;
      --panel: #0f172a;
      --card: #111827;
      --border: #1f2937;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #38bdf8;
      --accent2: #a78bfa;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 20% 20%, #0f172a 0, #0b1020 40%, #0b1020 100%);
      color: var(--text);
    }
    header {
      background: var(--panel);
      border-bottom: 1px solid var(--border);
      padding: 16px 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.25);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    h1 { margin: 0 0 6px; font-size: 22px; letter-spacing: 0.2px; }
    .subtitle { margin: 0; color: var(--muted); font-size: 14px; }
    main { max-width: 1100px; margin: 0 auto; padding: 22px 20px 40px; }
    .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.25);
    }
    .card h2 { margin: 0 0 4px; font-size: 18px; color: var(--accent); }
    .card h3 { margin: 12px 0 6px; font-size: 16px; color: var(--accent2); }
    .meta { color: var(--muted); font-size: 13px; margin-bottom: 10px; }
    pre {
      background: #0b1224;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px;
      overflow-x: auto;
      font-family: 'SFMono-Regular', Consolas, 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.5;
      margin: 0;
    }
    code { color: var(--text); }
    .chip {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(56, 189, 248, 0.12);
      border: 1px solid rgba(56, 189, 248, 0.35);
      color: var(--accent);
      font-size: 12px;
      margin-right: 8px;
    }
    .nav { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
    .nav a {
      color: var(--text);
      text-decoration: none;
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #0f172a;
    }
    a { color: var(--accent); }
    footer {
      border-top: 1px solid var(--border);
      margin-top: 24px;
      padding-top: 12px;
      color: var(--muted);
      font-size: 13px;
    }
  </style>

</head>
<body>
  <header>
    <h1>Chapter 3 ? C solutions</h1>
    <p class="subtitle">Each exercise folder from the repository, with its C source displayed inline.</p>
    <div class="nav">
      <a href="kandr-index.html">? Back to index</a>
      <a href="kandr-chapter-1.html">Chapter 1</a>
      <a href="kandr-chapter-2.html">Chapter 2</a>
      <a href="kandr-chapter-4.html">Chapter 4</a>
      <a href="kandr-chapter-5.html">Chapter 5</a>
      <a href="kandr-chapter-6.html">Chapter 6</a>
      <a href="kandr-chapter-7.html">Chapter 7</a>
      <a href="kandr-chapter-8.html">Chapter 8</a>
    </div>
  </header>
  <main>
    <div class="card">
      <h2>Exercise 3.01</h2>
      <p class="meta">chapter_3\exercise_3_01</p>
      <h3>binsearch.c</h3>
      <pre><code>
#include &lt;stdio.h&gt;
#include &lt;time.h&gt;

#define MAXLEN 10000
#define ITERATIONS 100000

void initVector(int v[], int n);
void printVector(int v[], int n);

int binsearch_kr(int x, int v[], int n);
int binsearch(int x, int v[], int n);

void test_binsearch(int binsearch(int x, int v[], int n), int x, int v[], int n);

int main(void)
{
  int v[MAXLEN];

  initVector(v, MAXLEN);
  // printVector(v, MAXLEN);

  int x = -1;

  // Test binsearch_kr()
  test_binsearch(binsearch_kr, x, v, MAXLEN);

  // Test binsearch()
  test_binsearch(binsearch, x, v, MAXLEN);

  return 0;
}

void initVector(int v[], int n)
{
  int i;
  for (i = 0; i &lt; n; ++i)
  {
    v[i] = i;
  }
}

void printVector(int v[], int n)
{
  int i;

  printf(&quot;[ &quot;);
  for (i = 0; i &lt; n; ++i)
  {
    (i != n - 1) ? printf(&quot;%d, &quot;, v[i]) : printf(&quot;%d ]\n&quot;, v[i]);
  }
}

int binsearch_kr(int x, int v[], int n)
{
  int low, mid, high;

  low = 0;
  high = n - 1;
  while (low &lt;= high)
  {
    mid = (low + high) / 2;

    if (x &lt; v[mid])
    {
      high = mid - 1;
    }
    else if (x &gt; v[mid])
    {
      low = mid + 1;
    }
    else
    {
      return mid;
    }
  }

  return -1;
}

int binsearch(int x, int v[], int n)
{
  int low, mid, high;

  low = 0;
  high = n - 1;
  while (low &lt;= high)
  {
    mid = (low + high) / 2;

    if (x &lt; v[mid])
    {
      high = mid - 1;
    }
    else
    {
      low = mid + 1;
    }
  }

  if (x == v[low - 1])
  {
    return low - 1;
  }

  return -1;
}

void test_binsearch(int binsearch(int x, int v[], int n), int x, int v[], int n)
{
  static int test_nr = 0;
  long clocks = clock();

  int i;
  for (i = 0; i &lt; ITERATIONS; ++i)
  {
    binsearch(x, v, n);
  }

  clocks = clock() - clocks;

  printf(&quot;test_%d: %lu clocks (%.4f seconds)\n&quot;, test_nr, clocks, (double)clocks / CLOCKS_PER_SEC);

  ++test_nr;
}

// NOTE: By using a simple test in the for loop there is a chance to increase the
// binsearch() execution speed. Just modifying an if-else statement from 3 branches
// with two condition testing to 2 branches with 1 condition testing will not
// increase drasticaly the program performance on modern machines, but is a better
// aproach.

      </code></pre>
    </div>
    <div class="card">
      <h2>Exercise 3.02</h2>
      <p class="meta">chapter_3\exercise_3_02</p>
      <h3>escape.c</h3>
      <pre><code>
#include &lt;stdio.h&gt;

#define MAXLEN 1000

int get_line(char line[], unsigned int limit);
void escape(char dest[], char src[]);
void unescape(char dest[], char src[]);

int main(void)
{
  char src[MAXLEN];
  char dest[MAXLEN];

  get_line(src, MAXLEN);
  printf(&quot;%s&quot;, src);

  escape(dest, src);
  printf(&quot;%s\n&quot;, dest);

  unescape(dest, src);
  printf(&quot;%s&quot;, dest);

  return 0;
}

int get_line(char line[], unsigned int limit)
{
  int i, c;
  for (i = 0; i &lt; limit - 1 &amp;&amp; (c = getchar()) != EOF &amp;&amp; c != &#x27;\n&#x27;; ++i)
  {
    line[i] = c;
  }

  if (c == &#x27;\n&#x27;)
  {
    line[i++] = c;
  }

  line[i] = &#x27;\0&#x27;;

  return i;
}

void escape(char dest[], char src[])
{
  int i, j;
  for (i = j = 0; src[i] != &#x27;\0&#x27;; ++i, ++j)
  {
    switch (src[i])
    {
    case &#x27;\a&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;a&#x27;;
      break;

    case &#x27;\b&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;b&#x27;;
      break;

    case &#x27;\f&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;f&#x27;;
      break;

    case &#x27;\n&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;n&#x27;;
      break;

    case &#x27;\r&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;r&#x27;;
      break;

    case &#x27;\t&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;t&#x27;;
      break;

    case &#x27;\v&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;v&#x27;;
      break;

    case &#x27;\\&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;\\&#x27;;
      break;

    case &#x27;\?&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;?&#x27;;
      break;

    case &#x27;\&#x27;&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;\&#x27;&#x27;;
      break;

    case &#x27;\&quot;&#x27;:
      dest[j++] = &#x27;\\&#x27;;
      dest[j] = &#x27;&quot;&#x27;;
      break;

    default:
      dest[j] = src[i];
      break;
    }
  }

  if (src[i] == &#x27;\0&#x27;)
  {
    dest[j] = src[i];
  }
}

void unescape(char dest[], char src[])
{
  int i, j;
  for (i = j = 0; src[i] != &#x27;\0&#x27;; ++i, ++j)
  {
    switch (src[i])
    {
    case &#x27;\\&#x27;:
      switch (src[++i])
      {
      case &#x27;a&#x27;:
        dest[j] = &#x27;\a&#x27;;
        break;

      case &#x27;b&#x27;:
        dest[j] = &#x27;\b&#x27;;
        break;

      case &#x27;f&#x27;:
        dest[j] = &#x27;\f&#x27;;
        break;

      case &#x27;n&#x27;:
        dest[j] = &#x27;\n&#x27;;
        break;

      case &#x27;r&#x27;:
        dest[j] = &#x27;\r&#x27;;
        break;

      case &#x27;t&#x27;:
        dest[j] = &#x27;\t&#x27;;
        break;

      case &#x27;v&#x27;:
        dest[j] = &#x27;\v&#x27;;
        break;

      case &#x27;\\&#x27;:
        dest[j] = &#x27;\\&#x27;;
        break;

      case &#x27;?&#x27;:
        dest[j] = &#x27;\?&#x27;;
        break;

      case &#x27;\&#x27;&#x27;:
        dest[j] = &#x27;\&#x27;&#x27;;
        break;

      case &#x27;&quot;&#x27;:
        dest[j] = &#x27;\&quot;&#x27;;
        break;

      default:
        dest[j++] = &#x27;\\&#x27;;
        dest[j] = src[i];
        break;
      }
      break;

    default:
      dest[j] = src[i];
      break;
    }
  }

  if (src[i] == &#x27;\0&#x27;)
  {
    dest[j] = src[i];
  }
}

      </code></pre>
    </div>
    <div class="card">
      <h2>Exercise 3.03</h2>
      <p class="meta">chapter_3\exercise_3_03</p>
      <h3>expand.c</h3>
      <pre><code>
#include &lt;stdio.h&gt;
#include &lt;ctype.h&gt;

#define MAXLEN 10000

int get_str(char str[], int limit);
void expand(char src[], char dest[]);

int main(void)
{
  char str[MAXLEN];
  char expanded_str[MAXLEN];

  get_str(str, MAXLEN);
  expand(str, expanded_str);
  printf(&quot;%s&quot;, expanded_str);

  return 0;
}

int get_str(char str[], int limit)
{
  int c, i = 0;

  while (i &lt; limit - 1 &amp;&amp; (c = getchar()) != EOF)
  {
    str[i++] = c;
  }
  str[i] = &#x27;\0&#x27;;

  return i;
}

void expand(char src[], char dest[])
{
  /**
   * a-z
   * a-b-c
   * a-c-h-v
   * a-c-b-v
   * 0-9
   * 1-5
   * a-zA-Z
   * 0-9a-zA-Z
   * -a-z
   * a-z-
   * -a-z-
   */
  int i, j = 0;
  for (i = 0; i &lt; MAXLEN - 1 &amp;&amp; j &lt; MAXLEN - 1 &amp;&amp; src[i] != EOF; ++i)
  {
    if (isalnum(src[i]) &amp;&amp; src[i + 1] == &#x27;-&#x27; &amp;&amp; src[i] &lt; src[i + 2])
    {
      do
      {
        int k;
        for (k = 0; k &lt;= (src[i + 2] - src[i]); ++k)
        {
          int temp = src[i] + k;
          if (dest[j - 1] != temp &amp;&amp; (isdigit(temp) || isalpha(temp)))
          {
            dest[j++] = temp;
          }
        }

        i += 2;
      } while (isalnum(src[i]) &amp;&amp; src[i + 1] == &#x27;-&#x27; &amp;&amp; src[i] &lt; src[i + 2]);
    }
    else
    {
      dest[j++] = src[i];
    }
  }
  dest[j] = &#x27;\0&#x27;;
}

      </code></pre>
    </div>
    <div class="card">
      <h2>Exercise 3.04</h2>
      <p class="meta">chapter_3\exercise_3_04</p>
      <h3>itoa.c</h3>
      <pre><code>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;limits.h&gt;

#define MAXLEN 1000

void int_to_array(int n, char s[]);
void str_reverse(char str1[], int index, int size);

int main(void)
{
  int n = 785;
  char number_str[MAXLEN];

  int_to_array(n, number_str);
  printf(&quot;%s\n&quot;, number_str);

  return 0;
}

void int_to_array(int n, char s[])
{
  int i, sign;

  sign = n;

  i = 0;
  do
  {
    s[i++] = abs(n % 10) + &#x27;0&#x27;;
  } while (n /= 10);

  if (sign &lt; 0)
  {
    s[i++] = &#x27;-&#x27;;
  }

  s[i] = &#x27;\0&#x27;;

  int s_len = strlen(s);
  str_reverse(s, 0, s_len - 1);
}

void str_reverse(char str1[], int index, int size)
{
  char temp;

  temp = str1[index];
  str1[index] = str1[size - index];
  str1[size - index] = temp;

  if (index == size / 2)
  {
    return;
  }

  str_reverse(str1, index + 1, size);
}

// NOTE: It does not handle the smallest negative number because it does not have
// a positive equivalent. This means that just using a expression like n = -n is
// not enough for the smallest negative number. If we take the absolute value of
// n % 10 we get the correct value and character.

      </code></pre>
    </div>
    <div class="card">
      <h2>Exercise 3.05</h2>
      <p class="meta">chapter_3\exercise_3_05</p>
      <h3>itob.c</h3>
      <pre><code>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#define MAXLEN 100

char itoc(int a);
void itob(int n, char s[], int b);
void str_reverse(char str1[], int index, int size);

int main(void)
{
  char s[MAXLEN];

  int n = -2;

  itob(n, s, 16);

  printf(&quot;%s&quot;, s);

  return 0;
}

char itoc(int a)
{
  if (a &lt;= 9)
  {
    return a + &#x27;0&#x27;;
  }

  return a + &#x27;a&#x27; - 10;
}

void itob(int n, char s[], int b)
{
  int i = 0, sign = n;

  do
  {
    s[i++] = itoc(abs(n) % b);
    n /= b;
  } while (n);

  switch (b)
  {
  case 2:
    s[i++] = &#x27;b&#x27;;
    s[i++] = &#x27;0&#x27;;
    break;

  case 16:
    s[i++] = &#x27;x&#x27;;
    s[i++] = &#x27;0&#x27;;
    break;
  }

  if (sign &lt; 0)
  {
    s[i++] = &#x27;-&#x27;;
  }

  s[i] = &#x27;\0&#x27;;

  int s_len = strlen(s);
  str_reverse(s, 0, s_len - 1);
}

void str_reverse(char str1[], int index, int size)
{
  char temp;

  temp = str1[index];
  str1[index] = str1[size - index];
  str1[size - index] = temp;

  if (index == size / 2)
  {
    return;
  }

  str_reverse(str1, index + 1, size);
}

// NOTE: It is simple to convert an integer variable to any base just by taking
// the remainder of the number divided by base and then dividing the initial
// number by base. The result need to be reversed to be correct.

      </code></pre>
    </div>
    <div class="card">
      <h2>Exercise 3.06</h2>
      <p class="meta">chapter_3\exercise_3_06</p>
      <h3>itoa.c</h3>
      <pre><code>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;limits.h&gt;

#define MAXLEN 1000

int ilen(int a);
void int_to_array(int n, char s[], int padding);
void str_reverse(char str1[], int index, int size);

int main(void)
{
  int n = 1995;
  char number_str[MAXLEN];

  int_to_array(n, number_str, 6);
  printf(&quot;%s\n&quot;, number_str);

  return 0;
}

int ilen(int a)
{
  int i = 0;

  do
  {
    ++i;
  } while (a /= 10);

  return i;
}

void int_to_array(int n, char s[], int padding)
{
  int i = 0, sign = n;

  do
  {
    s[i++] = abs(n % 10) + &#x27;0&#x27;;
  } while (n /= 10);

  if (sign &lt; 0)
  {
    s[i++] = &#x27;-&#x27;;
  }

  int len = ilen(sign);
  while (len &lt; padding)
  {
    s[i++] = &#x27; &#x27;;
    --padding;
  }

  s[i] = &#x27;\0&#x27;;

  int s_len = strlen(s);
  str_reverse(s, 0, s_len - 1);
}

void str_reverse(char str1[], int index, int size)
{
  char temp;

  temp = str1[index];
  str1[index] = str1[size - index];
  str1[size - index] = temp;

  if (index == size / 2)
  {
    return;
  }

  str_reverse(str1, index + 1, size);
}

      </code></pre>
    </div>
    <footer>Generated from OutisNemosseus/the-c-programming-language-2nd-edition-solutions ? Chapter page</footer>
  </main>
</body>
</html>