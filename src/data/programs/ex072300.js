// Chapter 7 Example 7.23
// Chapter 7 Example 7.23

const ex072300 = {
  "id": "ex072300",
  "title": "ex072300",
  "displayName": "Chapter 7 Example 7.23",
  "description": "Chapter 7 Example 7.23",
  "category": "DSP - Chapter 07",
  "chapter": "07",
  "source": "matlab",
  "pythonCode": "#!/usr/bin/env python3\n# Title: Chapter 7 Example 7.23\n# Chapter: 07\n# Source: Ingle DSP MATLAB Programs\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport io\nimport base64\n\n# Chapter 7 Example 7.23\r\n\r\n# Lowpass filter design using PM algorithm\r\n\r\n# wp = 0.2*np.pi; ws = 0.3*np.pi; Rp = 0.25; As = 50\ndelta1 = (10**(Rp/20)-1)/(10**(Rp/20)+1)\r\n\r\ndelta2 = (1+delta1)*(10**(-As/20))\r\n\r\ndeltaH = np.max(delta1,delta2); deltaL = np.min(delta1,delta2)\nweights = [delta2/delta1 1]\r\n\r\ndeltaf = (ws-wp)/(2*np.pi)\r\n\r\nM = np.ceil((-20*np.log10(np.sqrt(delta1*delta2))-13)/(14.6*deltaf)+1)\r\n\r\nf = [0 wp/np.pi ws/np.pi 1]\r\n\r\nm = [1 1 0 0]\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\ndelta_w = 2*np.pi/1000; wsi=ws/delta_w+1; wpi = wp/delta_w\nAsd = -np.max(dbnp.arange(wsi, 501 + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(wsi, 501 + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(wsi, 501 + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(wsi, 501 + 1, 1))\r\n\r\nM = M+1\nh = remez(M-1,f,m,weights)\n[db,mag,pha,grd,w] = freqz_m(h,[1])\nAsd = -np.max(dbnp.arange(wsi, 501 + 1, 1))\r\n\r\nM\r\n\r\n[Hr,omega,P,L] = ampl_res(h)\n# # Plots\r\n\r\nfig = plt.figure(1)\n plt.subplot(1, 1, 1)\nplt.subplot(2, 2, 1)\n stemnp.arange([0, M-1],h + 1, 1); plt.title('Actual Impulse Response')\nplt.plt.axis([0 M-1 -0.1 0.3]); plt.xlabel('n')\n plt.ylabel('h(n)')\nset(gca,'XTickMode','manual','XTick',[0,M-1])\r\n\r\nsetnp.arange(gca,'YTickMode','manual','YTick',[-0.1, 0.3] + 0.1, 0.1)\r\n\r\nplt.subplot(2, 2, 2)\nplt.plt.plt.plot(w/np.pi,db)\nplt.title('Magnitude Response in dB')\n\r\n\r\nplt.plt.axis([0,1,-80,10]); plt.xlabel('frequency in np.pi units')\n plt.ylabel('DECIBELS')\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-50,0])\nset(gca,'YTickLabelMode','manual','YTickLabels',['50';' 0']);plt.grid(True)\nplt.subplot(2, 2, 3)\nplt.plt.plt.plot(omega/np.pi,Hr)\nplt.title('Amplitude Response')\n\r\n\r\nplt.plt.axis([0 1 -0.1 1.1]); plt.xlabel('frequency in np.pi units')\n plt.ylabel('Hr(w)')\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,1]);plt.grid(True)\nplt.subplot(2, 2, 4)\n\r\n\r\npbw = omeganp.arange(1, wpi+1 + 1, 1)/np.pi; pbe = Hrnp.arange(1, wpi+1 + 1, 1)-1\nsbw = omeganp.arange(wsi+1, 501 + 1)/np.pi; sbe = Hrnp.arange(wsi+1, 501 + 1)\nplt.plt.plt.plot(pbw,pbe,sbw,sbe)\n\r\n\r\nplt.plt.axis([0,1,-deltaH,deltaH]);plt.title('Error Response')\n\r\n\r\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('Hr(w)')\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-deltaH,-deltaL,0,deltaL,deltaH])\nset(gca,'XGrid','on')\n# Save plot to base64\nbuf = io.BytesIO()\nplt.tight_layout()\nplt.savefig(buf, format='png', dpi=100, bbox_inches='tight')\nbuf.seek(0)\nimg_base64 = base64.b64encode(buf.read()).decode('utf-8')\nplt.close()\nprint(f\"data:image/png;base64,{img_base64}\")\n",
  "matlabCode": "% Chapter 7 Example 7.23\r\n\r\n%           Lowpass filter design using PM algorithm\r\n\r\n%\r\n\r\nwp = 0.2*pi; ws = 0.3*pi; Rp = 0.25; As = 50;\r\n\r\ndelta1 = (10^(Rp/20)-1)/(10^(Rp/20)+1)\r\n\r\ndelta2 = (1+delta1)*(10^(-As/20))\r\n\r\ndeltaH = max(delta1,delta2); deltaL = min(delta1,delta2);\r\n\r\nweights = [delta2/delta1 1]\r\n\r\ndeltaf = (ws-wp)/(2*pi)\r\n\r\nM = ceil((-20*log10(sqrt(delta1*delta2))-13)/(14.6*deltaf)+1)\r\n\r\nf = [0 wp/pi ws/pi 1]\r\n\r\nm = [1 1 0 0];\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\ndelta_w = 2*pi/1000; wsi=ws/delta_w+1; wpi = wp/delta_w;\r\n\r\nAsd = -max(db(wsi:1:501))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(wsi:1:501))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(wsi:1:501))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(wsi:1:501))\r\n\r\nM = M+1;\r\n\r\nh = remez(M-1,f,m,weights);\r\n\r\n[db,mag,pha,grd,w] = freqz_m(h,[1]);\r\n\r\nAsd = -max(db(wsi:1:501))\r\n\r\nM\r\n\r\n[Hr,omega,P,L] = ampl_res(h);\r\n\r\n%\r\n\r\n% Plots\r\n\r\nfigure(1); subplot(1,1,1)\r\n\r\nsubplot(2,2,1); stem([0:1:M-1],h); title('Actual Impulse Response')\r\n\r\naxis([0 M-1 -0.1 0.3]); xlabel('n'); ylabel('h(n)')\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,M-1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-0.1:0.1:0.3])\r\n\r\nsubplot(2,2,2);plot(w/pi,db);title('Magnitude Response in dB');\r\n\r\naxis([0,1,-80,10]); xlabel('frequency in pi units'); ylabel('DECIBELS')\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-50,0]);\r\n\r\nset(gca,'YTickLabelMode','manual','YTickLabels',['50';' 0']);grid\r\n\r\nsubplot(2,2,3);plot(omega/pi,Hr);title('Amplitude Response');\r\n\r\naxis([0 1 -0.1 1.1]); xlabel('frequency in pi units'); ylabel('Hr(w)')\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,1]);grid\r\n\r\nsubplot(2,2,4);\r\n\r\npbw = omega(1:1:wpi+1)/pi; pbe = Hr(1:1:wpi+1)-1;\r\n\r\nsbw = omega(wsi+1:501)/pi; sbe = Hr(wsi+1:501);\r\n\r\nplot(pbw,pbe,sbw,sbe);\r\n\r\naxis([0,1,-deltaH,deltaH]);title('Error Response');\r\n\r\nxlabel('frequency in pi units'); ylabel('Hr(w)')\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-deltaH,-deltaL,0,deltaL,deltaH]);\r\n\r\nset(gca,'XGrid','on')",
  "defaultParams": {},
  "params": [],
  "tags": [
    "chapter07",
    "dsp",
    "ex072300"
  ],
  "wikipediaLinks": [
    {
      "title": "Digital signal processing",
      "url": "https://en.wikipedia.org/wiki/Digital_signal_processing"
    }
  ]
};

export default ex072300;
