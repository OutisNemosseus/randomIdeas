// Chapter 8: Example 8.20
// Chapter 8: Example 8.20

const ex082000 = {
  "id": "ex082000",
  "title": "ex082000",
  "displayName": "Chapter 8: Example 8.20",
  "description": "Chapter 8: Example 8.20",
  "category": "DSP - Chapter 08",
  "chapter": "08",
  "source": "matlab",
  "pythonCode": "#!/usr/bin/env python3\n# Title: Chapter 8: Example 8.20\n# Chapter: 08\n# Source: Ingle DSP MATLAB Programs\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport io\nimport base64\n\n# Chapter 8: Example 8.20\r\n\r\n# BiLinear Transformation:\r\n\r\n# Elliptic Lowpass Filter Design\r\n\r\n# # Digital Filter Specifications:\r\n\r\nwp = 0.2*np.pi;                         # digital Passband freq in Hz\r\n\r\nws = 0.3*np.pi;                         # digital Stopband freq in Hz\r\n\r\nRp = 1;                              # Passband ripple in dB\r\n\r\nAs = 15;                             # Stopband attenuation in dB\r\n\r\n\r\n\r\n# Analog Prototype Specifications: Inverse mapping for frequencies\r\n\r\nT = 1; Fs = 1/T;                     # Set T=1\r\n\r\nOmegaP = (2/T)*np.tan(wp/2);            # Prewarp Prototype Passband freq\r\n\r\nOmegaS = (2/T)*np.tan(ws/2);            # Prewarp Prototype Stopband freq\r\n\r\nep = np.sqrt(10**(Rp/10)-1);             # Passband Ripple parameter\r\n\r\nRipple = np.sqrt(1/(1+ep*ep));          # Passband Ripple\r\n\r\nAttn = 1/(10**(As/20));               # Stopband Attenuation\r\n\r\n\r\n\r\n# Analog Elliptic Prototype Filter Calculation:\r\n\r\n[cs,ds] = afd_elip(OmegaP,OmegaS,Rp,As)\n# # *** Elliptic Filter Order =  3 \r\n\r\n\r\n\r\n# Bilinear transformation:\r\n\r\n[b,a] = bilinear(cs,ds,T)\n[C,B,A] = dir2cas(b,a)\r\n\r\n# # C = 0.1214\r\n\r\n# # B = 1.0000   -1.4211    1.0000\r\n\r\n# # 1.0000    1.0000         0\r\n\r\n# # A = 1.0000   -1.4928    0.8612\r\n\r\n# # 1.0000   -0.6183         0\r\n\r\n\r\n\r\n# Plotting\r\n\r\nfig = plt.figure(1)\n plt.subplot(1, 1, 1)\n[db,mag,pha,grd,w] = freqz_m(b,a)\nplt.subplot(2, 2, 1)\n plt.plt.plt.plot(w/np.pi,mag)\n plt.title('Magnitude Response')\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('|H|')\n plt.plt.axis([0,1,0,1.1])\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\nset(gca,'YTickmode','manual','YTick',[0,Attn,Ripple,1]); plt.grid(True)\nplt.subplot(2, 2, 3)\n plt.plt.plt.plot(w/np.pi,db)\n plt.title('Magnitude in dB')\n\r\n\r\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('decibels')\n plt.plt.axis([0,1,-40,5])\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\nset(gca,'YTickmode','manual','YTick',[-50,-15,-1,0]); plt.grid(True)\nset(gca,'YTickLabelMode','manual','YTickLabels',['50';'15';' 1';' 0'])\r\n\r\nplt.subplot(2, 2, 2)\n plt.plt.plt.plot(w/np.pi,pha/np.pi)\n plt.title('Phase Response')\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('np.pi units')\n plt.plt.axis([0,1,-1,1])\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\nset(gca,'YTickmode','manual','YTick',[-1,0,1]); plt.grid(True)\nplt.subplot(2, 2, 4)\n plt.plt.plt.plot(w/np.pi,grd)\n plt.title('Group Delay')\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('Samples')\n plt.plt.axis([0,1,0,15])\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1])\nsetnp.arange(gca,'YTickmode','manual','YTick',[0, 15] + 5, 5); plt.grid(True)\n# Save plot to base64\nbuf = io.BytesIO()\nplt.tight_layout()\nplt.savefig(buf, format='png', dpi=100, bbox_inches='tight')\nbuf.seek(0)\nimg_base64 = base64.b64encode(buf.read()).decode('utf-8')\nplt.close()\nprint(f\"data:image/png;base64,{img_base64}\")\n",
  "matlabCode": "% Chapter 8: Example 8.20\r\n\r\n%            BiLinear Transformation:\r\n\r\n%                Elliptic Lowpass Filter Design\r\n\r\n%\r\n\r\n% Digital Filter Specifications:\r\n\r\nwp = 0.2*pi;                         % digital Passband freq in Hz\r\n\r\nws = 0.3*pi;                         % digital Stopband freq in Hz\r\n\r\nRp = 1;                              % Passband ripple in dB\r\n\r\nAs = 15;                             % Stopband attenuation in dB\r\n\r\n\r\n\r\n% Analog Prototype Specifications: Inverse mapping for frequencies\r\n\r\nT = 1; Fs = 1/T;                     % Set T=1\r\n\r\nOmegaP = (2/T)*tan(wp/2);            % Prewarp Prototype Passband freq\r\n\r\nOmegaS = (2/T)*tan(ws/2);            % Prewarp Prototype Stopband freq\r\n\r\nep = sqrt(10^(Rp/10)-1);             % Passband Ripple parameter\r\n\r\nRipple = sqrt(1/(1+ep*ep));          % Passband Ripple\r\n\r\nAttn = 1/(10^(As/20));               % Stopband Attenuation\r\n\r\n\r\n\r\n% Analog Elliptic Prototype Filter Calculation:\r\n\r\n[cs,ds] = afd_elip(OmegaP,OmegaS,Rp,As);\r\n\r\n%%*** Elliptic Filter Order =  3 \r\n\r\n\r\n\r\n% Bilinear transformation:\r\n\r\n[b,a] = bilinear(cs,ds,T);\r\n\r\n[C,B,A] = dir2cas(b,a)\r\n\r\n%%C = 0.1214\r\n\r\n%%B = 1.0000   -1.4211    1.0000\r\n\r\n%%    1.0000    1.0000         0\r\n\r\n%%A = 1.0000   -1.4928    0.8612\r\n\r\n%%    1.0000   -0.6183         0\r\n\r\n\r\n\r\n% Plotting\r\n\r\nfigure(1); subplot(1,1,1)\r\n\r\n[db,mag,pha,grd,w] = freqz_m(b,a);\r\n\r\nsubplot(2,2,1); plot(w/pi,mag); title('Magnitude Response')\r\n\r\nxlabel('frequency in pi units'); ylabel('|H|'); axis([0,1,0,1.1])\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1]);\r\n\r\nset(gca,'YTickmode','manual','YTick',[0,Attn,Ripple,1]); grid\r\n\r\nsubplot(2,2,3); plot(w/pi,db); title('Magnitude in dB');\r\n\r\nxlabel('frequency in pi units'); ylabel('decibels'); axis([0,1,-40,5]);\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1]);\r\n\r\nset(gca,'YTickmode','manual','YTick',[-50,-15,-1,0]); grid\r\n\r\nset(gca,'YTickLabelMode','manual','YTickLabels',['50';'15';' 1';' 0'])\r\n\r\nsubplot(2,2,2); plot(w/pi,pha/pi); title('Phase Response')\r\n\r\nxlabel('frequency in pi units'); ylabel('pi units'); axis([0,1,-1,1]);\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1]);\r\n\r\nset(gca,'YTickmode','manual','YTick',[-1,0,1]); grid\r\n\r\nsubplot(2,2,4); plot(w/pi,grd); title('Group Delay')\r\n\r\nxlabel('frequency in pi units'); ylabel('Samples'); axis([0,1,0,15])\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1]);\r\n\r\nset(gca,'YTickmode','manual','YTick',[0:5:15]); grid\r\n\r\n\r\n\r\n",
  "defaultParams": {},
  "params": [],
  "tags": [
    "chapter08",
    "dsp",
    "ex082000"
  ],
  "wikipediaLinks": [
    {
      "title": "Digital signal processing",
      "url": "https://en.wikipedia.org/wiki/Digital_signal_processing"
    }
  ]
};

export default ex082000;
