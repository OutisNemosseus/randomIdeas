// Chapter 8: Example 8.26
// Chapter 8: Example 8.26

const ex082600 = {
  "id": "ex082600",
  "title": "ex082600",
  "displayName": "Chapter 8: Example 8.26",
  "description": "Chapter 8: Example 8.26",
  "category": "DSP - Chapter 08",
  "chapter": "08",
  "source": "matlab",
  "pythonCode": "#!/usr/bin/env python3\n# Title: Chapter 8: Example 8.26\n# Chapter: 08\n# Source: Ingle DSP MATLAB Programs\n\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport io\nimport base64\n\n# Chapter 8: Example 8.26\r\n\r\n# Chebyshev-1 Highpass Filter Design:\r\n\r\n# Use of the ZMAPPING function\r\n\r\n# # Digital Lowpass Filter Specifications:\r\n\r\nwplp = 0.2*np.pi;                         # digital Passband freq in Hz\r\n\r\nwslp = 0.3*np.pi;                         # digital Stopband freq in Hz\r\n\r\n  Rp = 1;                              # Passband ripple in dB\r\n\r\n  As = 15;                             # Stopband attenuation in dB\r\n\r\n\r\n\r\n# Analog Prototype Specifications: Inverse mapping for frequencies\r\n\r\nT = 1; Fs = 1/T;                       # Set T=1\r\n\r\nOmegaP = (2/T)*np.tan(wplp/2);            # Prewarp Prototype Passband freq\r\n\r\nOmegaS = (2/T)*np.tan(wslp/2);            # Prewarp Prototype Stopband freq\r\n\r\nep = np.sqrt(10**(Rp/10)-1);               # Passband Ripple parameter\r\n\r\nRipple = np.sqrt(1/(1+ep*ep));            # Passband Ripple\r\n\r\nAttn = 1/(10**(As/20));                 # Stopband Attenuation\r\n\r\n\r\n\r\n# Analog Chebyshev Prototype Filter Calculation:\r\n\r\n[cs,ds] = afd_chb1(OmegaP,OmegaS,Rp,As)\n# # *** Chebyshev-1 Filter Order =  4 \r\n\r\n\r\n\r\n# Bilinear transformation:\r\n\r\n[blp,alp] = bilinear(cs,ds,T)\n# Digital Highpass Filter Cutoff frequency:\r\n\r\nwphp = 0.6*np.pi;                            # Passband edge frequency\r\n\r\n\r\n\r\n# LP-to-HP frequency-band transformation:\r\n\r\nalpha = -(np.cos((wplp+wphp)/2))/(np.cos((wplp-wphp)/2))\r\n\r\n# # alpha = -0.3820\r\n\r\n\r\n\r\nNz = -[alpha,1]; Dz = [1,alpha]\n[bhp,ahp] = zmapping(blp,alp,Nz,Dz)\n[C,B,A] = dir2cas(bhp,ahp)\r\n\r\n# # C = 0.0243\r\n\r\n# # B = 1.0000   -2.0000    1.0000\r\n\r\n# # 1.0000   -2.0000    1.0000\r\n\r\n# # A = 1.0000    1.0416    0.4019\r\n\r\n# # 1.0000    0.5561    0.7647\r\n\r\n\r\n\r\n# Plotting\r\n\r\nfig = plt.figure(1)\n plt.subplot(1, 1, 1)\n[dbl,magl,phal,grdl,w] = freqz_m(blp,alp)\nplt.subplot(2, 2, 1)\n plt.plt.plt.plot(w/np.pi,magl)\n plt.title('Lowpass Filter Magnitude Response')\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('|H|')\n plt.plt.axis([0,1,0,1])\nset(gca,'XTickMode','manual','XTick',[0,0.2,1])\nset(gca,'YTickMode','manual','YTick',[0,Ripple,1]);plt.grid(True)\nplt.subplot(2, 2, 2)\n plt.plt.plt.plot(w/np.pi,dbl)\n plt.title('Lowpass Filter Magnitude in dB')\n\r\n\r\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('decibels')\n plt.xlim(0, 1)\nplt.ylim(-30, 0)\nset(gca,'XTickMode','manual','XTick',[0,0.2,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-30,-Rp,0]);plt.grid(True)\nset(gca,'YTickLabelMode','manual','YTickLabels',['30';' 1';' 0'])\n[dbh,magh,phah,grdh,w] = freqz_m(bhp,ahp)\nplt.subplot(2, 2, 3)\n plt.plt.plt.plot(w/np.pi,magh)\n plt.title('Highpass Filter Magnitude Response')\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('|H|')\n plt.plt.axis([0,1,0,1])\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.6,1])\nset(gca,'YTickMode','manual','YTick',[0,Ripple,1]);plt.grid(True)\nplt.subplot(2, 2, 4)\n plt.plt.plt.plot(w/np.pi,dbh)\n plt.title('Highpass Filter Magnitude in dB')\n\r\n\r\nplt.xlabel('frequency in np.pi units')\n plt.ylabel('decibels')\n plt.xlim(0, 1)\nplt.ylim(-30, 0)\nset(gca,'XTickMode','manual','XTick',[0,0.6,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-30,-Rp,0]);plt.grid(True)\nset(gca,'YTickLabelMode','manual','YTickLabels',['30';' 1';' 0'])\n# Save plot to base64\nbuf = io.BytesIO()\nplt.tight_layout()\nplt.savefig(buf, format='png', dpi=100, bbox_inches='tight')\nbuf.seek(0)\nimg_base64 = base64.b64encode(buf.read()).decode('utf-8')\nplt.close()\nprint(f\"data:image/png;base64,{img_base64}\")\n",
  "matlabCode": "% Chapter 8: Example 8.26\r\n\r\n%            Chebyshev-1 Highpass Filter Design:\r\n\r\n%                Use of the ZMAPPING function\r\n\r\n%\r\n\r\n% Digital Lowpass Filter Specifications:\r\n\r\nwplp = 0.2*pi;                         % digital Passband freq in Hz\r\n\r\nwslp = 0.3*pi;                         % digital Stopband freq in Hz\r\n\r\n  Rp = 1;                              % Passband ripple in dB\r\n\r\n  As = 15;                             % Stopband attenuation in dB\r\n\r\n\r\n\r\n% Analog Prototype Specifications: Inverse mapping for frequencies\r\n\r\nT = 1; Fs = 1/T;                       % Set T=1\r\n\r\nOmegaP = (2/T)*tan(wplp/2);            % Prewarp Prototype Passband freq\r\n\r\nOmegaS = (2/T)*tan(wslp/2);            % Prewarp Prototype Stopband freq\r\n\r\nep = sqrt(10^(Rp/10)-1);               % Passband Ripple parameter\r\n\r\nRipple = sqrt(1/(1+ep*ep));            % Passband Ripple\r\n\r\nAttn = 1/(10^(As/20));                 % Stopband Attenuation\r\n\r\n\r\n\r\n% Analog Chebyshev Prototype Filter Calculation:\r\n\r\n[cs,ds] = afd_chb1(OmegaP,OmegaS,Rp,As);\r\n\r\n%%*** Chebyshev-1 Filter Order =  4 \r\n\r\n\r\n\r\n% Bilinear transformation:\r\n\r\n[blp,alp] = bilinear(cs,ds,T);\r\n\r\n\r\n\r\n% Digital Highpass Filter Cutoff frequency:\r\n\r\nwphp = 0.6*pi;                            % Passband edge frequency\r\n\r\n\r\n\r\n% LP-to-HP frequency-band transformation:\r\n\r\nalpha = -(cos((wplp+wphp)/2))/(cos((wplp-wphp)/2))\r\n\r\n%%alpha = -0.3820\r\n\r\n\r\n\r\nNz = -[alpha,1]; Dz = [1,alpha];\r\n\r\n[bhp,ahp] = zmapping(blp,alp,Nz,Dz);\r\n\r\n[C,B,A] = dir2cas(bhp,ahp)\r\n\r\n%%C = 0.0243\r\n\r\n%%B = 1.0000   -2.0000    1.0000\r\n\r\n%%    1.0000   -2.0000    1.0000\r\n\r\n%%A = 1.0000    1.0416    0.4019\r\n\r\n%%    1.0000    0.5561    0.7647\r\n\r\n\r\n\r\n% Plotting\r\n\r\nfigure(1); subplot(1,1,1)\r\n\r\n[dbl,magl,phal,grdl,w] = freqz_m(blp,alp);\r\n\r\nsubplot(2,2,1); plot(w/pi,magl); title('Lowpass Filter Magnitude Response')\r\n\r\nxlabel('frequency in pi units'); ylabel('|H|'); axis([0,1,0,1]);\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,1]);\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,Ripple,1]);grid\r\n\r\nsubplot(2,2,2); plot(w/pi,dbl); title('Lowpass Filter Magnitude in dB');\r\n\r\nxlabel('frequency in pi units'); ylabel('decibels'); axis([0 1 -30 0]);\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.2,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-30,-Rp,0]);grid\r\n\r\nset(gca,'YTickLabelMode','manual','YTickLabels',['30';' 1';' 0']);\r\n\r\n[dbh,magh,phah,grdh,w] = freqz_m(bhp,ahp);\r\n\r\nsubplot(2,2,3); plot(w/pi,magh); title('Highpass Filter Magnitude Response')\r\n\r\nxlabel('frequency in pi units'); ylabel('|H|'); axis([0,1,0,1])\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.6,1]);\r\n\r\nset(gca,'YTickMode','manual','YTick',[0,Ripple,1]);grid\r\n\r\nsubplot(2,2,4); plot(w/pi,dbh); title('Highpass Filter Magnitude in dB');\r\n\r\nxlabel('frequency in pi units'); ylabel('decibels'); axis([0 1 -30 0]);\r\n\r\nset(gca,'XTickMode','manual','XTick',[0,0.6,1])\r\n\r\nset(gca,'YTickMode','manual','YTick',[-30,-Rp,0]);grid\r\n\r\nset(gca,'YTickLabelMode','manual','YTickLabels',['30';' 1';' 0']);\r\n\r\n",
  "defaultParams": {},
  "params": [],
  "tags": [
    "chapter08",
    "dsp",
    "ex082600"
  ],
  "wikipediaLinks": [
    {
      "title": "Digital signal processing",
      "url": "https://en.wikipedia.org/wiki/Digital_signal_processing"
    }
  ]
};

export default ex082600;
